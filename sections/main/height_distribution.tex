\section{Height Distribution}
\label{sec: height distribution}

Let \((T,\rf_T,H_T)\sim\pp\) be a random critical point.
Of particular interest, is the height distribution of minima
\[\begin{aligned}
	\Pr(\rf_T\in A \mid T\text{ is minimum})
	&=\Pr(\rf_T\in A \mid \negEV(H_T)=0)\\
	&= \frac{\Pr_{(\rf_T, H_T)}(A\times \negEV^{-1}(0))}{\Pr(\negEV(H_T)=0)}\\
	&= \int_A \underbrace{
		\frac{\int_{\negEV^{-1}(0)} \Omega(z,h) dh}{\Pr(T\text{ is min})}
	}_{=: \Psi_0(z)} dz.
\end{aligned}\]
It turns out to be absolutely continuous with density \(\Psi_0\). Unfortunately
our term for \(\Psi_0\) looks horrible. While \(\Omega\) itself might be
calculable, the set \(\negEV^{-1}(0)\) of positive definite matrices is anything
but pretty. We are therefore going to switch to the eigenvalues
\(\evH_1,\dots,\evH_\dims\) of the random matrix \(H\). We have
with some abuse of notation
\[
	\det(H) = \prod_{i=1}^\dims \evH_i
	\quad\text{and}\quad
	\negEV(H) = \negEV(\evH)
	= \frac1\dims \sum_{i=1}^\dims \ind_{\evH_i < 0}.
\]
So more generally for critical points of index \(\alpha\) we have
\[\begin{aligned}
	\Pr_{(\rf_T, H_T)}(A\times \negEV^{-1}(\alpha))
	&\overset{\text{def. }\Omega}= c\int_{A\times\negEV^{-1}(\alpha)} |\det(h)| p(z,h)dz dh\\
	&\overset{\text{def. } p}= c\E[\ind_{A}(Z)\ind_{\negEV^{-1}(\alpha)}(H)|\det(H)|]\\
	&= c\E[\ind_{A}(Z)
	\ind_{\negEV^{-1}(\alpha)}(\evH)\prod_{i=1}^\dims |\evH_i|]\\
	&= \int_A c\underbrace{
		\E\Big[
			\ind_{\negEV(\evH) = \alpha}\prod_{i=1}^\dims |\evH_i|
			\Bigm| Z=z
		\Big]
		\varphi_Z(z)
	}_{\sim\Psi_\alpha(z)}
	dz,
\end{aligned}\]
where \(\varphi_Z(z)\) is the marginal density of \(Z=Z(0)\). Now recall that we
derived the conditional distribution in Subsection~\ref{subsec: Lambda|rf}. And
it were simply GOE eigenvalues with an independent shift. So the height
distribution of minima is therefore up to constants
\[\begin{aligned}
	\Psi_\alpha(z)
	\overset{\eqref{eq: expectation f(Lambda) | Z}}&\sim
	\E\Bigg[
		\ind\Bigl\{
			\negEV\left(\evGOE \dotPlus \epsilon + \tfrac{\sqC'(0)}{\sqC(0)}z\right) = \alpha
		\Bigr\}
		\prod_{i=1}^\dims \left|
			\evGOE_i  + \epsilon + \tfrac{\sqC'(0)}{\sqC(0)}z
		\right|
	\Bigg]
	\varphi_\rf(z)\\
	&\sim \int \E\Bigg[
		\ind\Bigl\{
			\negEV\left(\evGOE \dotPlus t + \tfrac{\sqC'(0)}{\sqC(0)}z\right) = \alpha
		\Bigr\}
		\prod_{i=1}^\dims \left|
			\evGOE_i  + t + \tfrac{\sqC'(0)}{\sqC(0)}z
		\right|
	\Bigg]
	\varphi_\epsilon(t)dt
	\varphi_\rf(z),
\end{aligned}\]
where \(\varphi_\epsilon\) is the density of \(\normal\bigl(0,
\sqC''(0)-\frac{\sqC'(0)^2}{\sqC(0)}\bigr)\).

The interesting bit is
\[
	f_\dims(x):=\E\Bigg[
		\ind\Bigl\{
			\negEV\left(\evGOE \dotMinus x\right) = \alpha
		\Bigr\}
		\prod_{i=1}^\dims \left|
			\evGOE_i - x
		\right|
	\Bigg]
\]
using this abstraction we simply have
\[\begin{aligned}
	\Psi(z)
	&\sim \varphi_\rf(z)
	\int f_\dims\bigl(\tfrac{-\sqC'(0)}{\sqC(0)}z - t\bigr)
	\varphi_\epsilon(t)dt\\
	&= \varphi_\rf(z)
	(f_\dims * \varphi_\epsilon)\bigl(\tfrac{-\sqC'(0)}{\sqC(0)}z\bigr),
\end{aligned}\]
where \(f*g\) denotes the convolution of \(f\) and \(g\).

Let us now take a closer look at \(f_\dims\). 
By definition we have
\[
		\ind\Bigl\{
			\negEV\left(\evGOE \dotMinus x\right) = \alpha
		\Bigr\}
		= \ind\Bigl\{
			\frac1\dims\sum_{i=1}^\dims \ind_{\evGOE_i < x} = \alpha
		\Bigr\}
\]
So using the density of the
eigenvalues of the GOE \eqref{eq: GOE ev density} and \(a:=2\sqC''(0)\),
we can expand \(f_\dims\) to
\[
	f_\dims(x)
	= c^\evGOE_{\dims,a}\int
	\ind\Bigl\{
			\frac1\dims\sum_{i=1}^\dims \ind_{x_i < x} = \alpha
	\Bigr\}
	\underbrace{
	\prod_{i=1}^\dims \left|
		x_i - x
	\right|
	}_{=:(*)}
	e^{-\tfrac1{2a}\sum_{k=1}^\dims x_k^2} \Delta_N dx_1\dots dx_\dims
\]
where \(\Delta_\dims = \prod_{i<j}|x_i-x_j|\) is the Vandermonde
Determinant. Using the observation
\[
	\Delta_{\dims+1} = 
	\Delta_\dims\prod_{i=1}^\dims \left|
		x_i - x_{\dims+1}
	\right|,
\]
\textcite{fyodorovComplexityRandomEnergy2004} defined \(x_{\dims+1}:=x\) to
incorporate the determinant \((*)\) into the density of the GOE of dimension
\(\dims+1\). With a correction of the exponential and constant this
clever trick results in
\[\begin{aligned}
	&f_\dims(x_{\dims+1})\\
	&= \tfrac{c^\evGOE_{\dims, a}}{c^\evGOE_{\dims+1,a}}
	e^{\tfrac{x_{\dims+1}^2}{2a}}
	\int \ind\Bigl\{
			\frac1\dims\sum_{i=1}^\dims \ind_{x_i < x_{\dims+1}} = \alpha
	\Bigr\}
	\varphi^\evGOE_{\dims+1,a}(x_1,\dots,x_{\dims+1})
	dx_1\dots d_{x_\dims},
\end{aligned}\]
where \(\varphi^\evGOE_{\dims+1,a}\) is the eigenvalue density of the GOE
in \(\dims+1\) dimensions. At this point
\textcite{fyodorovComplexityRandomEnergy2004} was done, but we still have an
indicator left over. For this indicator to be one, exactly \(\dims\alpha\)
of the \(x_i\) need to be smaller \(x_{\dims+1}\). For the ordering
\(x_{(1)}\le\dots\le x_{(\dims+1)}\), we therefore have
\[
	\ind\Bigl\{
			\frac1\dims\sum_{i=1}^\dims \ind_{x_i < x_{\dims+1}} = \alpha
	\Bigr\}
	= \ind\{x_{(\dims\alpha+1)} = x_{\dims+1}\}.
\]
It is now helpful to calculate the density of \(\evGOE_{(k)}\) for an ordering
\(\evGOE_{(1)}\le\dots\le\evGOE_{(m)}\) of the GOE eigenvalues of \(m\)
dimensions. Since \(\evGOE_1,\dots,\evGOE_m\) are exchangeable random
variables, we get
\[\begin{aligned}
	\Pr(\evGOE_{(k)}\in A)
	&= \int \varphi^\evGOE_{m,a}(x_1,\dots,x_m) \ind_{x_{(k)}\in A}dx_1\dots dx_m\\
	&= \int \varphi^\evGOE_{m,a}(x_1,\dots,x_m) \ind_{x_{(k)}\in A}
	\sum_{i=1}^m \ind_{x_{(k)}=x_i} dx_1\dots dx_m\\
	&= \sum_{i=1}^m \int \varphi^\evGOE_{m,a}(x_1,\dots,x_m) \ind_{x_i\in A}
	\ind_{x_{(k)}=x_i} dx_1\dots dx_m\\
	\overset{\text{exchangeable}}&= m \int \varphi^\evGOE_{m,a}(x_1,\dots,x_m)
	\ind_{x_m\in A} \ind_{x_{(k)}=x_m} dx_1\dots dx_m\\
	&= \int_A \underbrace{m\left(\int \varphi^\evGOE_{m,a}(x_1,\dots,x_m)
	\ind_{x_{(k)}=x_m} dx_1\dots dx_{m-1}\right)}_{
		= \varphi_{\evGOE_{(k)}}(x_m)
	} dx_m.
\end{aligned}\]
If we take \(m=\dims+1\), \(k=\dims\alpha+1\) and re-substitute
\(x=x_{\dims+1}\) we can put the last three equations together to finally
get
\[
	f_\dims(x)
	= \tfrac{c^\evGOE_{\dims, a}}{c^\evGOE_{\dims+1,a}}
	\exp\bigl(\tfrac{x^2}{2a}\bigr)
	\frac1{\dims+1}\varphi_{\evGOE_{(\dims\alpha+1)}}(x).
\]




